import React, { useState, useEffect } from 'react';
import './Home.css';

interface ImageData {
  src: string;
  alt: string;
  caption: string;
  category: string;
}

const Home: React.FC = () => {
  const [selectedImage, setSelectedImage] = useState<ImageData | null>(null);
  const [activeFilter, setActiveFilter] = useState<string>('all');
  const [filteredImages, setFilteredImages] = useState<ImageData[]>([]);
  const [isMeetingOpen, setIsMeetingOpen] = useState(false);
  const [showWelcomePopup, setShowWelcomePopup] = useState(true);

  const images: ImageData[] = [
    {
      src: "/assets/images/hemja1.jpg",
      alt: "Hemja Community Gathering",
      caption: "Community members enjoying the picnic",
      category: "gathering"
    },
    {
      src: "/assets/images/490983525_1787680558628917_2042399229713310511_n.jpg",
      alt: "Community Activity",
      caption: "Fun activities and games",
      category: "activities"
    },
    {
      src: "/assets/images/489980282_1385217469150391_7321237762334734584_n.jpg",
      alt: "Community Event",
      caption: "Group discussions and networking",
      category: "discussion"
    }
  ];

  const categories = ['all', ...Array.from(new Set(images.map(img => img.category)))];

  useEffect(() => {
    if (activeFilter === 'all') {
      setFilteredImages(images);
    } else {
      setFilteredImages(images.filter(img => img.category === activeFilter));
    }
  }, [activeFilter]);

  const openLightbox = (image: ImageData) => {
    setSelectedImage(image);
    document.body.style.overflow = 'hidden';
  };

  const closeLightbox = () => {
    setSelectedImage(null);
    document.body.style.overflow = 'auto';
  };

  const navigateImage = (direction: 'prev' | 'next') => {
    if (!selectedImage) return;
    
    const currentIndex = filteredImages.findIndex(img => img.src === selectedImage.src);
    let newIndex;
    
    if (direction === 'next') {
      newIndex = (currentIndex + 1) % filteredImages.length;
    } else {
      newIndex = (currentIndex - 1 + filteredImages.length) % filteredImages.length;
    }
    
    setSelectedImage(filteredImages[newIndex]);
  };

  const shareImage = async () => {
    if (!selectedImage) return;
    
    try {
      if (navigator.share) {
        await navigator.share({
          title: 'Hemja Welfare Society',
          text: selectedImage.caption,
          url: window.location.href
        });
      }
    } catch (err) {
      console.error('Error sharing:', err);
    }
  };

  const downloadImage = () => {
    if (!selectedImage) return;
    
    const link = document.createElement('a');
    link.href = selectedImage.src;
    link.download = `hemja-${selectedImage.category}-${Date.now()}.jpg`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  };

  return (
    <main className="main-content">
      {showWelcomePopup && (
        <>
          <div className="welcome-popup-overlay" onClick={() => setShowWelcomePopup(false)} />
          <div className="welcome-popup">
            <button className="close-popup" onClick={() => setShowWelcomePopup(false)}>├Ч</button>
            <div className="welcome-content">
              <h1 className="welcome-title">Welcome to the Hemja Welfare Society Website</h1>
              
              <p className="welcome-text">
                We are currently working on building and updating our website. Upcoming events and important announcements will be posted here shortly.
              </p>
              
              <p className="welcome-text">
                In the meantime, we are collecting information about individuals from Hemja who are currently living in the USA.
              </p>
              
              <p className="welcome-text">
                Please use the link below to submit your details:
              </p>
              
              <a 
                href="https://forms.gle/LSrkJMLpqcEMVtwK6" 
                target="_blank" 
                rel="noopener noreferrer" 
                className="form-link"
              >
                <span className="emoji-pointer">ЁЯСЙ</span>
                Submit Your Details
              </a>
              
              <p className="thank-you">
                Thank you for your support!
              </p>
            </div>
          </div>
        </>
      )}

      <section className="community-gallery">
        <h2 className="gallery-title">Our Community in Hemja Picnic 2024</h2>
        
        <div className="filter-buttons">
          {categories.map(category => (
            <button
              key={category}
              className={`filter-button ${activeFilter === category ? 'active' : ''}`}
              onClick={() => setActiveFilter(category)}
            >
              {category.charAt(0).toUpperCase() + category.slice(1)}
            </button>
          ))}
        </div>

        <div className="image-grid">
          {filteredImages.map((image, index) => (
            <div 
              key={index} 
              className="image-item"
              onClick={() => openLightbox(image)}
            >
              <div className="image-container">
                <img 
                  src={image.src} 
                  alt={image.alt}
                  loading="lazy"
                  onLoad={(e) => e.currentTarget.classList.add('loaded')}
                />
                <div className="image-overlay">
                  <p className="image-caption">{image.caption}</p>
                  <span className="zoom-icon">ЁЯФН</span>
                  <span className="image-category">{image.category}</span>
                </div>
              </div>
            </div>
          ))}
        </div>
      </section>

      <section className="meeting-section">
        <div className="meeting-header" onClick={() => setIsMeetingOpen(!isMeetingOpen)}>
          <h2>рддреЗрд╕реНрд░реЛ рдмреИрдардХрдмрд╛рдЯ рдирд┐рдореНрди рдмрд┐рд╖рдп рд╣рд░реБрдорд╛ рдЫрд▓рдлрд▓ рдЧрд░реА рдирд┐рд░реНрдгрдп рдЧрд░рд┐рдпреЛ</h2>
          <span className={`meeting-toggle ${isMeetingOpen ? 'open' : ''}`}>тЦ╝</span>
        </div>
        
        {isMeetingOpen && (
          <div className="meeting-content">
            <div className="greeting">
              <p>рдпрд╣рд╛рдБрд╣рд░реБ рд╕рдВрдореНрдкреБрд░реНрдгрдорд╛ рдирдорд╕реНрдХрд╛рд░</p>
              <p>рдирдпрд╛рдБ рдмрд░реНрд╖ реирежреореи рд╕рд╛рд▓рдХреЛ рд╣рд╛рд░реНрджрд┐рдХ рдордВрдЧрд▓рдордп рд╢реБрднрдХрд╛рдордирд╛ рд╡реНрдпрдХреНрдд рдЧрд░реНрджрдЫреМрдВрее</p>
            </div>

            <div className="meeting-info">
              <p>рд╣рд╛рдореНрд░реЛ рд╕рдВрд╕реНрдерд╛ рд╣реЗрдордЬрд╛ рд╡реЗрд▓рдлреЗрдпрд░ рд╕реЛрд╕рд╛рдИрдЯреА рд╕реНрдерд╛рдкрдирд╛ рдХрд╛рд▓рджреЗрдЦрд┐ рдиреИрдВ рдмрд┐рднрд┐рдиреНрди рдЪрд░рдгрд╣рд░реБ рдкрд╛рд░ рдЧрд░реНрджреИрдВ рдпрд╣рд╛рдБрд╕рдореНрдо рдЖрдПрдХреЛ рдХреБрд░рд╛ рдпрд╣рд╛рдБрд╣рд░реБрд▓рд╛рдИ рдерд╛рд╣рд╛рдиреИрдВ рдЫ рддрдерд╛рдкрд┐ рд╣рд╛рдорд┐рд▓реЗ рдЧрд░реНрдиреБрдкрд░реНрдиреЗ рд░ рдЧрд░реНрдирд╕рдХреНрдиреЗ рдХрддрд┐рдкрдп рдХреБрд░рд╛рд╣рд░реБ рд╕рдордпрдорд╛ рдЧрд░реНрди рд╕рдХреЗрдиреМрдВ рд░ рднреИрдВрдкрд░рд┐ рдЖрдПрдХрд╛ рдХрддрд┐рдкрдп рдкрд░рд┐рдШрдЯрдирд╛рд╣рд░реБрд▓рд╛рдИ рд╣рд╛рдорд┐рд╕рдмреИрдВрдХреЛ рд╕рд╣рдпреЛрдЧрдмрд╛рдЯ рд╕рдорд╛рдзрд╛рдирдкрдирд┐ рдЧрд░реНрдпреМрдВредрдЕрдм рд╣рд╛рдореНрд░реЛ рдХрд╛рдо рднрдиреЗрдХреЛ рд╕рдВрд╕реНрдерд╛рд▓рд╛рдИ рдЪрд▓рд╛рдпрдорд╛рди рдмрдирд╛рдЙрдиреЗ рд░ рдкреНрд░рддреЗрдХ рд╣реЗрдордЬрд╛рдмрд╛рд╕реАрд╣рд░реБрд▓рд╛рдИ рд╕рдВрд╕реНрдерд╛рдорд╛ рдЖрд╡рджреНрдж рдЧрд░рд╛рдПрд░ рдЕрд░реБ рдЙрджреНрджреЗрд╢реНрдпрд╣рд░реБ рдкреБрд░рд╛ рдЧрд░реНрджреИрдВ рд╕рдВрд╕реНрдерд╛рд▓рд╛рдИ рдЖрд░реНрдерд┐рдХ рд░ рд╕рд╛рдорд╛рдЬрд┐рдХ рд░реБрдкрдорд╛ рдЕрдЭ рд╕рдВрдХреНрд╖рдо рд░ рд╕рдмрд▓ рдмрдирд╛рдИ рд╣рд╛рдореНрд░реЛ рд╣реЗрдордЬрд╛рд╕рдореНрдо рдЬреЛрдбреНрдиреЗ рд╣реЛредрддреНрдпрд╕рдХреЛ рд▓рд╛рдЧрд┐ рдпрд╣рд╛рдБрд╣рд░реБрдХреЛ рд╕рд╛рде,рд╕рдорд░реНрдерди рд░ рд╕рд╣рдпреЛрдЧрдХреЛ рдЕрдЭ рдмрдврд┐ рдЖрд╡рд╕реНрдпрдХрддрд╛ рд░рд╣рдиреНрдЫ рддреНрдпрд╕рдХрд╛рд░рдг рдпрд╣рд╛рдБрд╣рд░реБрдмрд╛рдЯ рдзреЗрд░реИрдВ рдЕрдкреЗрдХреНрд╖рд╛ рд░рд╛рдЦреЗрдХрд╛рдЫреМрдВ рд░ рдЖрдЙрджрд╛ рджрд┐рдирд╣рд░реБрдорд╛ рд╣рд╛рдорд┐ рдХреНрд░рдорд╢ рд╕рдВрд╕реНрдерд╛рд▓рд╛рдИ рд╕рдмрд▓ рдмрдирд╛рдЙрдиреЗ рддрд░реНрдл рдЕрдЧрд╛рдбреА рдмрдвреНрдиреЗ рдЫреМрдВред</p>
              
              <p className="meeting-date">April 6, 2025 рдорд╛ Hicksville рдорд╛ рд╕рдореНрдкрдиреНрди</p>

              <div className="committee-section">
                <h3>рд╕рдВрд╕реНрдерд╛рдкрдХ рд╕рдВрд░рдХреНрд╖рдХ:</h3>
                <p>рд╡рд┐рд╢реНрдм рд░рд╛рдЬ рдмрд╛рдБрд╕реНрддреЛрд▓рд╛</p>

                <h3>рд╕рдВрд░рдХреНрд╖рдХ:</h3>
                <ul>
                  <li>рдЧрдВрдЧрд╛рдзрд░ рддреНрд░рд┐рдкрд╛рдареА</li>
                  <li>рдЯреЗрдХ рдм. рдХреБрдБрд╡рд░</li>
                  <li>рдореЛрд╣рди рдХреНрд╖реЗрддреНрд░рд┐</li>
                  <li>рдзреНрд░реБрд╡ рдХреБрдБрд╡рд░</li>
                </ul>

                <h3>рдХрд╛рд░реНрдп рд╕рдорд┐рддрд┐</h3>
                <ul>
                  <li>рдЕрдзреНрдпрдХреНрд╖: рдзреНрд░реБрд╡ рд░рд╛рдЬ рдкреМрдВрдбреЗрд▓</li>
                  <li>рдЙрдкрд╛рдзреНрдпрдХреНрд╖: рдкрджрдо рджрд╛рд╣рд╛рд▓</li>
                  <li>рдо.рдЙрдкрд╛рдзреНрдпрдХреНрд╖: рд▓рдХреНрд╖реНрдорд┐ рдерд╛рдкрд╛</li>
                  <li>рдорд╣рд╛рд╕рдЪрд┐рд╡: рд╡рд┐рд╢реНрд╡ рд░рд╛рдЬ рддрд┐рдорд┐рд▓реНрд╕рд┐рдирд╛</li>
                  <li>рд╕рдЪрд┐рд╡: рдмрд┐рд░ рдм.рдХреБрдБрд╡рд░</li>
                  <li>рдХреЛрд╖рд╛рдзреНрдпрдХреНрд╖: рд▓рд╛рд▓ рдмрд╣рд╛рджреБрд░ рдЬрд┐.рд╕рд┐</li>
                  <li>рд╕рджрд╕реНрдп: рдкрджрдо рдХреБрдБрд╡рд░</li>
                  <li>рд╕рджрд╕реНрдп: рд╕реБрдорди рдмрд╛рдБрд╕реНрддреЛрд▓рд╛</li>
                  <li>рд╕рджрд╕реНрдп: рдмрд┐рджреБрд░ рд╕рд╛рдкрдХреЛрдЯрд╛</li>
                  <li>рд╕рджрд╕реНрдп: рд╕рд┐рддрд╛ рддрд┐рдорд┐рд▓реНрд╕рд┐рдирд╛</li>
                  <li>рд╕рджрд╕реНрдп: рдЧрдо рдм. рдиреЗрдкрд╛рд▓реА</li>
                </ul>

                <h3>рд╕рд▓реНрд▓рд╛рд╣рдХрд╛рд░рд╣рд░реБ</h3>
                <div className="advisors-grid">
                  <div className="advisor-group">
                    <h4>рдиреНрдпреБрдпреЛрд░реНрдХ:</h4>
                    <ul>
                      <li>рдирд┐рд░рдЬ рдХреЗ.рд╕рд┐.</li>
                      <li>рдЕрд╢реЛрдХ рд░рд╛рдирд╛</li>
                      <li>рдирд┐рд░рдЬ рд╕рд╛рдкрдХреЛрдЯрд╛</li>
                      <li>рдирд╡рд┐рди рдХреБрдорд╛рд░ рдЕрдзрд┐рдХрд╛рд░реА</li>
                    </ul>
                  </div>
                  <div className="advisor-group">
                    <h4>рд╢рд┐рдХрд╛рдЧреЛ:</h4>
                    <ul>
                      <li>рдЧрдВрдЧрд╛ рдерд╛рдкрд╛</li>
                    </ul>
                  </div>
                  <div className="advisor-group">
                    <h4>рдиреНрдпреБрдЬрд░реНрд╕рд┐:</h4>
                    <ul>
                      <li>рд╣рд░рд┐ рдЦрдбреНрдХрд╛</li>
                    </ul>
                  </div>
                  <div className="advisor-group">
                    <h4>рднрд░реНрдЬрд┐рдирд┐рдпрд╛:</h4>
                    <ul>
                      <li>рдЬрдирдХ рдХреБрдБрд╡рд░</li>
                    </ul>
                  </div>
                  <div className="advisor-group">
                    <h4>рдХреНрдпрд╛рд▓рд┐рдлреЛрд░реНрдирд┐рдпрд╛:</h4>
                    <ul>
                      <li>рдЕрдирд┐рд▓ рдХреБрдБрд╡рд░</li>
                    </ul>
                  </div>
                  <div className="advisor-group">
                    <h4>рдЯреЗрдХреНрд╕рд╕:</h4>
                    <ul>
                      <li>рдЧреЛрд╡рд┐рдиреНрдж рдХреБрдБрд╡рд░</li>
                      <li>рд░рд╛рдЬреБ рддрд┐рдорд┐рд▓реНрд╕рд┐рдирд╛</li>
                      <li>рдЧреЛрд╡рд┐рдиреНрдж рдЕрдзрд┐рдХрд╛рд░реА</li>
                    </ul>
                  </div>
                  <div className="advisor-group">
                    <h4>рдкреЗрдиреНрд╕рд▓рднреЗрдирд┐рдпрд╛:</h4>
                    <ul>
                      <li>-</li>
                    </ul>
                  </div>
                  <div className="advisor-group">
                    <h4>рдЬрд░реНрдЬрд┐рдпрд╛:</h4>
                    <ul>
                      <li>рд╣рд░рд┐ рддрд┐рдорд┐рд▓реНрд╕рд┐рдирд╛</li>
                      <li>рдзрди рдм.рдХреБрдБрд╡рд░</li>
                    </ul>
                  </div>
                  <div className="advisor-group">
                    <h4>рдореЗрд░рд┐рд▓реНрдпрд╛рдиреНрдб:</h4>
                    <ul>
                      <li>рдирд╡рд┐рди рд░рд╛рдЬ рдкреМрдВрдбреЗрд▓</li>
                    </ul>
                  </div>
                  <div className="advisor-group">
                    <h4>рдХреЛрд▓реЛрд░рд╛рдбреЛ:</h4>
                    <ul>
                      <li>рд╢рд┐рд╡рд╣рд░рд┐ рдЕрдзрд┐рдХрд╛рд░реА</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        )}
      </section>

      {selectedImage && (
        <div className="lightbox" onClick={closeLightbox}>
          <div className="lightbox-content" onClick={e => e.stopPropagation()}>
            <button className="close-button" onClick={closeLightbox}>├Ч</button>
            <div className="lightbox-navigation">
              <button className="nav-button prev" onClick={() => navigateImage('prev')}>тЭо</button>
              <img 
                src={selectedImage.src} 
                alt={selectedImage.alt}
                className="lightbox-image"
              />
              <button className="nav-button next" onClick={() => navigateImage('next')}>тЭп</button>
            </div>
            <div className="lightbox-actions">
              <button className="action-button" onClick={shareImage}>
                <span className="action-icon">ЁЯУд</span> Share
              </button>
              <button className="action-button" onClick={downloadImage}>
                <span className="action-icon">тмЗя╕П</span> Download
              </button>
            </div>
            <p className="lightbox-caption">{selectedImage.caption}</p>
          </div>
        </div>
      )}
    </main>
  );
};

export default Home; 